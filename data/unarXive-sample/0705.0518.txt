
Leonard triples and hypercubesŠtefko MiklavičThe author gratefully acknowledges support by the
US Department of State and the Fulbright Scholar Program,
and thanks the University of Wisconsin-Madison for hospitality
during his visit in Spring 2007.
Supported in part by
“Javna agencija za raziskovalno dejavnost Republike Slovenije”, program no. Z1-9614.
Department of Mathematics and Computer Science Faculty of Education, University of Primorska 6000 Koper, Slovenia miklavic@pef.upr.si2020/09/07 17:58:05Let FORMULA  denote a vector space over FORMULA  with finite positive dimension.
By a Leonard triple on FORMULA  we mean an ordered triple of linear operators on FORMULA  such that
for each of these operators there exists a basis of FORMULA  with respect to which the matrix
representing that operator is diagonal and the matrices representing the other two operators are
irreducible tridiagonal.
Let FORMULA  denote a positive integer and let FORMULA  denote the graph of the FORMULA -dimensional
hypercube. Let FORMULA  denote the vertex set of FORMULA  and let FORMULA  denote the adjacency
matrix of FORMULA . Fix FORMULA  and let FORMULA  denote the corresponding dual adjacency
matrix. Let FORMULA  denote the subalgebra of FORMULA  generated by FORMULA . We refer to FORMULA  as the
Terwilliger algebra of FORMULA  with respect to FORMULA . The
matrices FORMULA  and FORMULA  are related by the fact that FORMULA  and
FORMULA , where FORMULA  and FORMULA .
We show that the triple FORMULA , FORMULA , FORMULA  acts on each irreducible FORMULA -module as a
Leonard triple. We give a detailed description of these Leonard triples.
Introduction
We start by recalling the definition of a Leonard pair.
To describe this object we use the following terms.
Let FORMULA  denote the field of complex numbers.
A square matrix with entries in FORMULA  is called tridiagonal
whenever each nonzero entry lies on either the diagonal, the subdiagonal, or the superdiagonal.
A tridiagonal matrix is called irreducible whenever each entry on the subdiagonal is nonzero
and each entry on the superdiagonal is nonzero.
Definition 1.1 
{{cite:5beb405d-35e8-4dcd-9549-0ea5441e8df9}} Let FORMULA  denote a vector space over FORMULA  with finite positive
dimension. By a Leonard pair on FORMULA  we mean an ordered pair of linear operators
FORMULA  and FORMULA  which satisfy the conditions (i), (ii) below.
(i)
There exists a basis for FORMULA  with respect to which the matrix representing FORMULA  is
diagonal and the matrix representing FORMULA  is irreducible tridiagonal.
(ii)
There exists a basis for FORMULA  with respect to which the matrix representing FORMULA  is
diagonal and the matrix representing FORMULA  is irreducible tridiagonal.


Leonard pairs have been explored as linear algebraic objects, in connection with orthogonal
polynomials, and as representations of certain algebras {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}}–{{cite:2d2dd93d-e31f-4307-8fe9-8d2e2bab892e}}.
The notion of a Leonard triple was introduced by Curtin in {{cite:81cc603d-c83a-4c8e-9cb3-9e722953b9a5}}. We recall the definition.
Definition 1.2 
{{cite:81cc603d-c83a-4c8e-9cb3-9e722953b9a5}}
Let FORMULA  denote a vector space over FORMULA  with finite positive dimension. By a Leonard triple on
FORMULA  we mean an ordered triple of linear operators FORMULA , FORMULA , FORMULA  which
satisfy the conditions (i)–(iii) below.
(i)
There exists a basis for FORMULA  with respect to which the matrix representing FORMULA  is
diagonal and the matrices representing FORMULA  and FORMULA  are each irreducible tridiagonal.
(ii)
There exists a basis for FORMULA  with respect to which the matrix representing FORMULA  is
diagonal and the matrices representing FORMULA  and FORMULA  are each irreducible tridiagonal.
(iii)
There exists a basis for FORMULA  with respect to which the matrix representing FORMULA  is
diagonal and the matrices representing FORMULA  and FORMULA  are each irreducible tridiagonal.


Leonard triples are closely related to Leonard pairs.
Indeed, any ordered pair of distinct elements of a Leonard triple form a Leonard pair.
This allows us to take advantage of the literature concerning Leonard pairs in our
study of Leonard triples.
The isomorphism classes of Leonard pairs are in bijective correspondence with the polynomials in
the terminating branch of Askey-Wilson scheme {{cite:c1fc4117-0ef4-44f1-bb2c-2f4033b8e280}}, {{cite:22e6da99-9279-4e83-9718-d3170c921ce9}}. In particular, results concerning
Leonard pairs also have interpretations as results concerning such polynomials. Consequently,
results concerning Leonard triples also have interpretations as results concerning such polynomials.
Leonard pairs play a role in representation theory {{cite:ca86a52c-5df6-4b27-a6d8-cdfe9abb8da9}}, {{cite:24948f65-10dd-4962-9b61-0dd343140e16}}, {{cite:62a2aa61-2c37-41f3-b791-090ef69988ea}}, {{cite:5beb405d-35e8-4dcd-9549-0ea5441e8df9}}, {{cite:530adb38-3776-46ce-9e61-9e2515f1b6ce}} and
combinatorics {{cite:7c7be073-82ff-4819-a7f3-c6482e6f7f05}}, {{cite:45c14dfc-8b43-4fe5-9aa1-7fe2a6261093}}, {{cite:1c40b245-5ac5-4ce1-b5e2-4ace8d8169f2}}, {{cite:e1f87611-1482-4531-918b-9bbb42ea91df}}, {{cite:ca86a52c-5df6-4b27-a6d8-cdfe9abb8da9}}, {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}}, {{cite:94fd8ea6-fd19-4acc-898d-de23e35bfe4e}}. Consequently, also Leonard triples
play a role in representation theory and combinatorics.
Leonard triples are also related to spin models {{cite:4b57f618-e14d-40df-8f6c-fabda4066550}}, generalized Markov problem in
number theory and the Poncelet problem in projective geometry {{cite:34ec21c6-abed-40bb-9ebb-8a9347891768}}.
In this paper we consider a situation in graph theory where Leonard triples arise naturally. The
situation is described as follows. Let FORMULA  denote a positive integer, let FORMULA  denote the graph of
the hypercube with dimension FORMULA  (see Section  for formal definitions), and let FORMULA 
denote the vertex set of FORMULA . Let FORMULA  denote the FORMULA -algebra of matrices with entries in FORMULA 
and with rows and columns indexed by FORMULA . Let FORMULA  denote the adjacency matrix of FORMULA . For
the rest of this introduction fix FORMULA . Let FORMULA  denote the diagonal matrix in FORMULA  with
FORMULA -entry FORMULA  for FORMULA , where FORMULA  denotes path-length distance. The
matrix FORMULA  is called the dual adjacency matrix of FORMULA  with respect to FORMULA  {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}}.
Let FORMULA  denote the subalgebra of FORMULA  generated by FORMULA . The algebra FORMULA  is known as the
Terwilliger algebra of FORMULA  with respect to FORMULA  {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}}. As we shall see, FORMULA  and
FORMULA  are related by the fact that FORMULA  and FORMULA , where
FORMULA  and FORMULA . We call FORMULA  the imaginary adjacency matrix of
FORMULA  with respect to FORMULA . The matrices FORMULA , FORMULA , FORMULA  are similar; indeed we display an
invertible matrix FORMULA  such that FORMULA , FORMULA , FORMULA .
Let FORMULA  denote an irreducible FORMULA -module. We show that the triple FORMULA , FORMULA , FORMULA  acts
on FORMULA  as a Leonard triple. We give this triple a detailed description which is summarized as
follows. Consider the three bases for FORMULA  afforded by Definition REF .
For each of these bases we display two normalizations that we find attractive, and this yields
six bases for FORMULA . We compute the matrices which represent FORMULA , FORMULA , FORMULA  with respect to these
six bases. We display the inner products between each pair of these bases. We then display the
transition matrices between each pair of these bases.
We remark that our paper extends the work of Go {{cite:e1f87611-1482-4531-918b-9bbb42ea91df}}.

Preliminaries
In this section we review some definitions and basic results concerning distance-regular graphs.
See the book of Brouwer, Cohen and Neumaier {{cite:52df2dd1-f838-4ab8-93f7-d4a307df5ee4}} for more background information.
Let FORMULA  denote a nonempty finite set. Let FORMULA  denote the FORMULA -algebra of matrices with entries in
FORMULA  and with rows and columns indexed by FORMULA . For FORMULA  let FORMULA  and FORMULA  denote the
transpose and the complex conjugate of FORMULA , respectively. Let FORMULA  denote the vector space over
FORMULA  consisting of column vectors with entries in FORMULA  and rows indexed by FORMULA . We observe FORMULA 
acts on FORMULA  by left multiplication. We refer to FORMULA  as the standard module of FORMULA . For
FORMULA  let FORMULA  and FORMULA  denote the transpose and the complex conjugate of FORMULA , respectively.
We endow FORMULA  with the Hermitean inner product FORMULA . For
FORMULA  let FORMULA  denote the vector in FORMULA  with a 1 in the FORMULA  coordinate and 0 in all other
coordinates. Observe that FORMULA  is an orthogonal basis for FORMULA . The following will
be useful: for each FORMULA  we have
FORMULA 
Let FORMULA  denote a finite, undirected, connected graph, without loops or multiple edges, with
vertex set FORMULA , edge set FORMULA , path-length distance function FORMULA , and diameter
FORMULA  FORMULA . For a vertex FORMULA  and an integer FORMULA  let
FORMULA  denote the set of vertices at distance FORMULA  from FORMULA . For an integer FORMULA  we say
FORMULA  is regular with valency FORMULA  whenever FORMULA  for all FORMULA . We say FORMULA  is
distance-regular whenever for all integers FORMULA  and all FORMULA  with
FORMULA  the number
FORMULA 
is independent of FORMULA . The constants FORMULA  are known as the intersection numbers of FORMULA .
From now on we assume FORMULA  is distance-regular with FORMULA . For convenience set
FORMULA , FORMULA ,
FORMULA , FORMULA , and FORMULA , FORMULA .
We observe that FORMULA  is regular with valency FORMULA  and that FORMULA  for FORMULA .
By {{cite:52df2dd1-f838-4ab8-93f7-d4a307df5ee4}} the following hold for FORMULA : (i) FORMULA  if one of FORMULA  is
greater than the sum of the other two; and (ii) FORMULA  if one of FORMULA  equals the sum of
the other two.
We now recall the Bose-Mesner algebra of FORMULA . For FORMULA  let FORMULA  denote the
matrix in FORMULA  with entries
FORMULA 
We abbreviate FORMULA  and call this the adjacency matrix of FORMULA . Let FORMULA 
denote the subalgebra of FORMULA  generated by FORMULA . By {{cite:52df2dd1-f838-4ab8-93f7-d4a307df5ee4}} the matrices
FORMULA  form a basis for FORMULA . We call FORMULA  the
Bose-Mesner algebra of FORMULA . We observe that FORMULA  is commutative and semi-simple.
By {{cite:52df2dd1-f838-4ab8-93f7-d4a307df5ee4}} there exists a basis FORMULA  for FORMULA  such that
FORMULA 
where FORMULA  and FORMULA  denote the identity and the all-ones matrix of FORMULA , respectively. For convenience
we define FORMULA  if FORMULA  or FORMULA . The matrices FORMULA  are known as the
primitive idempotents of FORMULA , and FORMULA  is called the trivial idempotent.
We recall the eigenvalues of FORMULA . Since FORMULA  is a basis for FORMULA , there exist
scalars FORMULA  such that
FORMULA 
Combining this with (REF ) and () we find FORMULA  for
FORMULA  and FORMULA . The scalars FORMULA  are real
{{cite:00aa0b71-6290-4f67-a7fc-45da752ea981}}. Observe that FORMULA  are mutually distinct since FORMULA 
generates FORMULA . We refer to FORMULA  as the eigenvalue of FORMULA  associated with FORMULA . For
FORMULA  let FORMULA  denote the rank of FORMULA . We call FORMULA  the multiplicity of FORMULA .
By ()–(),
FORMULA 
By linear interpolation,
FORMULA 
We now recall the FORMULA -polynomial property. Note that FORMULA  for
FORMULA , where FORMULA  is the entry-wise multiplication. Therefore FORMULA  is closed under
FORMULA . Thus there exist FORMULA  such that
FORMULA 
By {{cite:52df2dd1-f838-4ab8-93f7-d4a307df5ee4}} the scalars FORMULA  are real and nonnegative for
FORMULA . The FORMULA  are called the Krein parameters of FORMULA . The graph FORMULA  is
said to be FORMULA -polynomial (with respect to the given ordering FORMULA  of the
primitive idempotents) whenever the following hold for FORMULA : (i) FORMULA  if one of
FORMULA  is greater than the sum of the other two; and (ii) FORMULA  if one of FORMULA  equals
the sum of the other two.

The Terwilliger algebra
In this section we recall the dual Bose-Mesner algebra and the Terwilliger algebra of FORMULA .
For the rest of this section fix FORMULA .
For FORMULA  let FORMULA  denote the diagonal matrix in FORMULA  with entries
FORMULA 
We call FORMULA  the FORMULA th dual idempotent of FORMULA  with respect to FORMULA . We observe
FORMULA 
By construction FORMULA  are linearly independent. Let FORMULA  denote the
subalgebra of FORMULA  spanned by FORMULA . We call FORMULA  the dual Bose-Mesner
algebra of FORMULA  with respect to FORMULA . We observe FORMULA  is commutative and semi-simple.
Assume FORMULA  is FORMULA -polynomial with respect to the ordering FORMULA  of the
primitive idempotents. Let FORMULA  denote the diagonal matrix in FORMULA  with FORMULA -entry
FORMULA 
where FORMULA . We call FORMULA  the dual adjacency matrix of FORMULA  with respect to FORMULA .
By {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}} FORMULA  is generated by FORMULA . We recall the dual eigenvalues of FORMULA .
Since FORMULA  is a basis for FORMULA 
there exist FORMULA  such that
FORMULA 
Combining this with () we find FORMULA .
By {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}} FORMULA  are real. The scalars
FORMULA  are mutually distinct since FORMULA  generates FORMULA .
Note that FORMULA  is an eigenvalue of FORMULA  and FORMULA  is the corresponding eigenspace
FORMULA . Using (REF )–() we find
FORMULA 
We call the sequence FORMULA  the dual eigenvalue sequence of  FORMULA .
Observe that for FORMULA  the rank of FORMULA  is FORMULA . Therefore
FORMULA  is the multiplicity with which FORMULA  appears as an eigenvalue of FORMULA .
By linear interpolation we obtain
FORMULA 
By {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}} the following hold for FORMULA :
FORMULA 
Let FORMULA  denote the subalgebra of FORMULA  generated by FORMULA  and FORMULA . We call FORMULA  the
Terwilliger algebra of FORMULA  with respect to FORMULA  {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}}.
By a FORMULA -module we mean a subspace FORMULA  of FORMULA  such that FORMULA 
for all FORMULA . Let FORMULA  denote a FORMULA -module. Then FORMULA  is said to be irreducible whenever
FORMULA  is nonzero and FORMULA  contains no FORMULA -modules other than 0 and FORMULA .
By construction FORMULA  is closed under the conjugate-transpose map so FORMULA  is semi-simple
{{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}}. By {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}} FORMULA  decomposes into an orthogonal direct sum
of irreducible FORMULA -modules. Let FORMULA  denote an irreducible FORMULA -module. By {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}}
FORMULA  is the orthogonal direct sum of the nonvanishing FORMULA  FORMULA  and the orthogonal
direct sum of the nonvanishing FORMULA .
By the endpoint of FORMULA  we mean FORMULA . By the
diameter of FORMULA  we mean FORMULA . By the
dual endpoint of FORMULA  we mean FORMULA . By the
dual diameter of FORMULA  we mean FORMULA . By
{{cite:ca86a52c-5df6-4b27-a6d8-cdfe9abb8da9}} the diameter and the dual diameter of FORMULA  coincide.
Let FORMULA  and FORMULA  denote the endpoint and the dual endpoint of FORMULA , respectively, and let FORMULA  denote
the diameter of FORMULA . By {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}} the following hold for
FORMULA :
FORMULA 
FORMULA 
Let FORMULA  denote an irreducible FORMULA -module. By {{cite:ba2a81d9-d2c1-40cb-9130-438bdd124494}} the following
are equivalent: (i) dimFORMULA  for FORMULA ; (ii) dimFORMULA 
for FORMULA . In this case FORMULA  is called thin.

The hypercubes
In this section we recall the hypercube graph and some of its basic properties.
Let FORMULA  denote a positive integer, and let FORMULA  denote the set of sequences
FORMULA , where FORMULA  for FORMULA . Let FORMULA  denote
the graph with vertex set FORMULA , and where two vertices are adjacent
if and only if they differ in exactly one coordinate. We call FORMULA  the FORMULA -cube or a
hypercube. The graph FORMULA  is connected and for FORMULA  the distance FORMULA 
is the number of coordinates at which FORMULA  and FORMULA  differ. In particular the diameter of FORMULA 
equals FORMULA . The graph FORMULA  is bipartite with bipartition FORMULA , where FORMULA  (resp. FORMULA )
is the set of vertices of FORMULA  with an even (resp. odd) number of positive coordinates. By
{{cite:52df2dd1-f838-4ab8-93f7-d4a307df5ee4}} FORMULA  is distance-regular with intersection numbers
FORMULA 
Let FORMULA  denote the eigenvalues of FORMULA . By {{cite:52df2dd1-f838-4ab8-93f7-d4a307df5ee4}} these
eigenvalues and their multiplicities are given by
FORMULA 
For FORMULA  let FORMULA  denote the primitive idempotent of FORMULA  associated with FORMULA .
By {{cite:52df2dd1-f838-4ab8-93f7-d4a307df5ee4}}, FORMULA  is FORMULA -polynomial
with respect to FORMULA . Moreover, it follows from
{{cite:52df2dd1-f838-4ab8-93f7-d4a307df5ee4}} that
FORMULA 
Since FORMULA  is bipartite,
FORMULA 
Let FORMULA  denote the dual eigenvalue sequence of FORMULA  for the given
FORMULA -polynomial structure. Then FORMULA  {{cite:e1f87611-1482-4531-918b-9bbb42ea91df}}.
Fix FORMULA . Let FORMULA  denote the corresponding dual adjacency matrix,
and let FORMULA  denote the corresponding Terwilliger algebra. By (REF ) and since
FORMULA  we have
FORMULA 
Since FORMULA  is vertex-transitive the isomorphism class of FORMULA  does not dependent on FORMULA .
For notational convenience, for the rest of this paper we assume FORMULA .
By {{cite:e1f87611-1482-4531-918b-9bbb42ea91df}} we have
FORMULA 
Let FORMULA  denote an irreducible FORMULA -module. By {{cite:e1f87611-1482-4531-918b-9bbb42ea91df}} FORMULA  is thin.
By {{cite:e1f87611-1482-4531-918b-9bbb42ea91df}} the endpoint and the dual endpoint of FORMULA  coincide.
Denoting this common value by FORMULA  we have FORMULA  and FORMULA ,
where FORMULA  is the diameter of FORMULA  {{cite:e1f87611-1482-4531-918b-9bbb42ea91df}} .

The Cartesian product and the Kronecker product
In this section we recall the Cartesian product of graphs and the Kronecker product of matrices.
For graphs FORMULA  and FORMULA  let FORMULA  denote the graph with vertex set
FORMULA , and with vertex FORMULA  being adjacent to vertex FORMULA  if and only if either FORMULA 
and FORMULA  is adjacent to FORMULA  in FORMULA , or FORMULA  and FORMULA  is adjacent to FORMULA  in FORMULA . We call
FORMULA  the Cartesian product of FORMULA  and FORMULA .
For FORMULA  and FORMULA  let FORMULA  denote the matrix in
FORMULA , with a FORMULA -entry equal to the FORMULA -entry of FORMULA  times the
FORMULA -entry of FORMULA . We call FORMULA  the Kronecker product of FORMULA  and FORMULA .
By {{cite:0801b6aa-7ab0-44bd-b87c-ab98e4d4bc61}}
FORMULA 
Also by {{cite:0801b6aa-7ab0-44bd-b87c-ab98e4d4bc61}}
FORMULA 
where FORMULA . It is also known that
FORMULA 
For a matrix FORMULA  and an integer FORMULA  let FORMULA  denote
FORMULA  (FORMULA  copies). We interpret FORMULA .
Let FORMULA  and FORMULA  be graphs with adjacency matrices FORMULA  and FORMULA , respectively. By construction the
adjacency matrix of FORMULA  is equal to FORMULA  where FORMULA  and FORMULA  are
the identity matrices of appropriate dimensions (see, for example, {{cite:a725b954-ac39-46ca-a95c-8fdf8c7eefcf}}).
The hypercube FORMULA  can be viewed as a Cartesian product FORMULA 
(FORMULA  copies). By a simple induction argument we find that the adjacency matrix FORMULA  of FORMULA  satisfies
FORMULA 
where FORMULA  and FORMULA  denote the adjacency matrix of FORMULA  and the FORMULA  identity matrix,
respectively. The reader is invited to verify that a similar equation holds
for the dual adjacency matrix FORMULA  of the hypercube FORMULA :
FORMULA 

The imaginary adjacency matrix of  FORMULA
In this section we define the imaginary adjacency matrix of the hypercube FORMULA .
We use the following notation.
Notation 6.1 
Let FORMULA  denote a positive integer and let FORMULA  denote the FORMULA -cube. Let FORMULA  denote the
adjacency matrix of FORMULA  and let FORMULA  denote the identity matrix in FORMULA . Fix
FORMULA , and let FORMULA  and FORMULA  denote the corresponding dual
adjacency matrix and the Terwilliger algebra, respectively. We define the matrix FORMULA  by
FORMULA 
where FORMULA .

Note that FORMULA . We have the following observation.
Lemma 6.2 
With reference to Notation REF , for FORMULA  the (y,z)-entry of FORMULA  is given by
FORMULA 

Proof. Since FORMULA  is diagonal we obtain FORMULA  and
FORMULA . By (REF ) FORMULA  and
FORMULA . The result now follows using (REF ).  FORMULA
Motivated by Lemma REF  we call FORMULA  the imaginary adjacency matrix of FORMULA 
with respect to FORMULA . The following result will be useful.
Lemma 6.3 
With reference to Notation REF  the following (i)–(iii) hold.
(i)
FORMULA ,
(ii)
FORMULA ,
(iii)
FORMULA .


Proof. (i) Immediate from (REF ).
(ii), (iii)
Eliminate FORMULA  using (REF ) and simplify using (REF ) and
().  FORMULA
Lemma 6.4 
With reference to Notation REF  we have
FORMULA 
where FORMULA  denotes the imaginary adjacency matrix of FORMULA  and FORMULA  denotes the FORMULA 
identity matrix.

Proof. Evaluate the left-hand side using (REF ) and then (REF ), (REF ). Simplify the
result using (REF )–() and FORMULA .  FORMULA

The eigenvalues of the imaginary adjacency matrix
In this section we describe the eigenvalues for the imaginary adjacency matrix of FORMULA .
We begin with a definition.
Definition 7.1 
With reference to Notation REF  we define
FORMULA 
where FORMULA  is the matrix with
rows and columns indexed by the set FORMULA , and with FORMULA -entry 1, FORMULA -entry 1,
FORMULA -entry FORMULA , and FORMULA -entry FORMULA .

Lemma 7.2 
With reference to Notation REF  and Definition REF  we have FORMULA .

Proof. Observe that the symmetric group FORMULA  acts on FORMULA  as a group of automorphisms of FORMULA  by the rule
FORMULA 
where FORMULA  is a vertex of FORMULA . In fact FORMULA  is isomorphic to the stabilizer of the vertex FORMULA  in the full automorphism group of FORMULA  {{cite:52df2dd1-f838-4ab8-93f7-d4a307df5ee4}}.
Observe that the above FORMULA -action on FORMULA  induces an FORMULA -action on FORMULA . For FORMULA  let
FORMULA  denote the matrix in FORMULA  that represents FORMULA  with respect to the basis
FORMULA . By {{cite:d954f0f8-d7cb-4d6f-b762-982e183fb069}} FORMULA  is the centralizer algebra for FORMULA  on FORMULA , i.e.
FORMULA 
Pick distinct FORMULA  and consider the involution FORMULA .
Since FORMULA  is generated by the involutions, to show FORMULA  it suffices to show
FORMULA . For FORMULA  the FORMULA -entry of FORMULA  is 1 if
FORMULA  and 0 if FORMULA . By this and matrix multiplication the FORMULA -entry
of FORMULA  is FORMULA  and the FORMULA -entry of FORMULA  is FORMULA .
By (REF ) and the definition of the Kronecker product FORMULA .
By these comments FORMULA . Therefore FORMULA  so
FORMULA .  FORMULA
We have an observation.
Lemma 7.3 
With reference to Notation REF  and Definition REF  the following (i)–(iii) hold.
(i)
FORMULA ;
(ii)
FORMULA ;
(iii)
FORMULA  exists.


Proof. (i) We first observe that FORMULA , where FORMULA  denotes the FORMULA 
identity matrix. Using (REF ) and (REF ) we now obtain
FORMULA 
(ii) We first observe that FORMULA . Using (REF ) we now obtain
FORMULA 
(iii) Clear from (ii) above.  FORMULA
Theorem 7.4 
With reference to Notation REF  and Definition REF ,
FORMULA 

Proof. To verify the equation on the left, evaluate FORMULA  using (REF ) and FORMULA  using
(REF ), (REF ), (REF ). Comparing the results using FORMULA  we find
FORMULA . The other two equations are similarly obtained.  FORMULA
Corollary 7.5 
With reference to Notation REF  the following (i)–(iii) hold.
(i)
The matrix FORMULA  is diagonalizable.
(ii)
The eigenvalues of FORMULA  are FORMULA .
(iii)
For FORMULA  the eigenvalue FORMULA  of FORMULA  has multiplicity FORMULA .


Proof. Use (REF ) and the equation on the right in Theorem REF .  FORMULA

The primitive idempotents of the imaginary adjacency matrix
In this section we consider the primitive idempotents for the imaginary adjacency matrix of FORMULA .
We start with a definition.
Definition 8.1 
With reference to Notation REF , for FORMULA  we define FORMULA ,
where FORMULA  is from Definition REF  and FORMULA  is the FORMULA th primitive idempotent of FORMULA .

Adopt Notation REF . Using Definition REF , ()–(REF ),
(REF ), Lemma REF (i), and the equation on the right in Theorem REF 
we routinely find
FORMULA 
For FORMULA  we note that FORMULA  is the primitive idempotent of FORMULA  associated with the
eigenvalue FORMULA . It follows from () that FORMULA .
We call FORMULA  the FORMULA th imaginary idempotent of FORMULA  with respect to FORMULA . For the rest
of this paper we consider the following situation.
Notation 8.2 
Let FORMULA  denote a positive integer and let FORMULA  denote the FORMULA -cube. Let FORMULA  denote the
adjacency matrix of FORMULA  and let FORMULA  denote the identity matrix in FORMULA . Let FORMULA  denote the
standard module of FORMULA . Fix FORMULA , and let FORMULA  and FORMULA  denote
the corresponding dual adjacency and the imaginary adjacency matrix, respectively. Let FORMULA  denote
the corresponding Terwilliger algebra. Let FORMULA , FORMULA , FORMULA 
denote the primitive idempotents, the dual idempotents and the imaginary idempotents of FORMULA ,
respectively. Let the matrix FORMULA  be as in Definition REF .

We record the following for later use.
Lemma 8.3 
With reference to Notation REF  the following (i), (ii) hold.
(i)
For FORMULA , FORMULA  is the eigenspace of FORMULA  for the
eigenvalue FORMULA .
(ii)
FORMULA .


Proof. (i) This follows from ().
(ii) Evaluate FORMULA  using () and Definition REF  to obtain
FORMULA  (direct sum). This sum is orthogonal by () and ().
 FORMULA
Lemma 8.4 
With reference to Notation REF  the following holds for FORMULA :
FORMULA 

Proof. To verify the left equation, simplify the right-hand side using (REF ) and the equation on
the left in Theorem REF . Compare the result with (REF ) and recall
FORMULA  for FORMULA .
The other two equations are similarly obtained.  FORMULA
Corollary 8.5 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module.
Then the following holds for FORMULA :
FORMULA 

Proof. Immediate from Lemma REF  and since FORMULA  by Lemma REF .  FORMULA
Corollary 8.6 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module.
Then FORMULA  for FORMULA .

Proof. This follows from Corollary REF  and since
dimFORMULA  for FORMULA .  FORMULA
Lemma 8.7 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i), (ii) hold.
(i)
FORMULA  if and only if FORMULA  FORMULA ;
(ii)
FORMULA          (orthogonal direct sum).


Proof. (i) By Corollary REF  we have FORMULA . By (REF ) we have
FORMULA  if and only if FORMULA . The result follows.
(ii)
Recall that FORMULA  (direct sum) by (REF ). Therefore
FORMULA  (direct sum). Simplify this equation using FORMULA  and
Corollary REF  to obtain FORMULA  (direct sum). This sum is orthogonal by () and ().  FORMULA
Lemma 8.8 
With reference to Notation REF  the following (i)–(v) are equivalent for
FORMULA :
(i)
FORMULA ;
(ii)
FORMULA ;
(iii)
FORMULA ;
(iv)
FORMULA ;
(v)
FORMULA .


Proof. By Theorem REF  and Lemma REF  we have
FORMULA , FORMULA ,
FORMULA  and FORMULA .
The result now follows in view of (REF ), () and (REF ).  FORMULA

Six bases for an irreducible FORMULA -module
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module.
We are going to show that the triple FORMULA , FORMULA , FORMULA  acts on FORMULA  as a Leonard triple.
We start with a lemma.
Lemma 9.1 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i)–(iii) hold.
(i)
For a nonzero FORMULA , each of the following two sequences is a basis for FORMULA :
FORMULA 
FORMULA 
(ii)
For a nonzero FORMULA , each of the following two sequences is a basis for FORMULA :
FORMULA 
FORMULA 
(iii)
For a nonzero FORMULA , each of the following two sequences is a basis for FORMULA :
FORMULA 
FORMULA 


Proof. It follows from {{cite:e1f87611-1482-4531-918b-9bbb42ea91df}} that the pair FORMULA  acts on FORMULA  as a Leonard pair.
Therefore (REF ) and (REF ) are bases for FORMULA  by {{cite:c1fc4117-0ef4-44f1-bb2c-2f4033b8e280}}.
By Lemma REF  and Corollary REF  the sequence (REF ) (resp. (REF )) is
the image under FORMULA  (resp. FORMULA ) of the sequence (REF ), provided FORMULA  is normalized so that
FORMULA  (resp. FORMULA ). Similarly, the sequence (REF ) (resp. (REF )) is
the image under FORMULA  (resp. FORMULA ) of the sequence (REF ), provided FORMULA  is normalized so that
FORMULA  (resp. FORMULA ). Since FORMULA  is invertible, the sequences (REF ), (REF ),
(REF ) and (REF ) are bases for FORMULA .  FORMULA
The following result will be useful.
Lemma 9.2 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i)–(iii) hold.
(i)
For a nonzero FORMULA ,
FORMULA 
(ii)
For a nonzero FORMULA ,
FORMULA 
(iii)
For a nonzero FORMULA ,
FORMULA 


Proof. (i) Evaluate FORMULA  using (REF ) and (REF ) to obtain the equation on the left
in (REF ). Evaluate FORMULA  using (REF ) and Lemma REF (i) to obtain the equation on the right in (REF ).
(ii), (iii) Similar to the proof of (i) above.  FORMULA
For future use we record an idea from the proof of Lemma REF .
Lemma 9.3 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i), (ii) hold.
(i)
The basis (REF ) (resp. (REF ), (REF )) is the image under FORMULA  of the
basis (REF ) (resp. (REF ), (REF )), provided FORMULA 
(resp. FORMULA , FORMULA ) is normalized so that FORMULA  (resp. FORMULA , FORMULA ).
(ii)
The basis (REF ) (resp. (REF ), (REF )) is the image under FORMULA  of the
basis (REF ) (resp. (REF ), (REF )), provided FORMULA 
(resp. FORMULA , FORMULA ) is normalized so that FORMULA  (resp. FORMULA , FORMULA ).


Remark 9.4 With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Note that the definition of a standard basis for FORMULA 
{{cite:e1f87611-1482-4531-918b-9bbb42ea91df}} is different from the
definition of the basis (REF ). However, it turns out that these definitions are equivalent.
Similarly, the definition of a dual standard basis for FORMULA  {{cite:e1f87611-1482-4531-918b-9bbb42ea91df}} is
equivalent to the definition of the basis (REF ). We will therefore prove all the results of
Section  and Section , although some of these results were
already proven in {{cite:e1f87611-1482-4531-918b-9bbb42ea91df}}.


The action of FORMULA , FORMULA , FORMULA 
on the six bases
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module with diameter
FORMULA . In this section we display the matrices which represent the action of FORMULA , FORMULA  and FORMULA 
on FORMULA  with respect to the six bases from Lemma REF . We use the following notation.
Let FORMULA  denote the FORMULA -algebra of all FORMULA  matrices with entries in FORMULA . The
rows and columns of matrices in FORMULA  shall be indexed by FORMULA . Let
FORMULA  denote a basis for FORMULA . For FORMULA  and FORMULA  we say FORMULA 
represents FORMULA  with respect to FORMULA  whenever
FORMULA  for FORMULA . We have a comment. For an invertible FORMULA 
the following are equivalent: (i) the matrix FORMULA  represents FORMULA  with respect to
FORMULA ; (ii) the matrix FORMULA  represents FORMULA  with respect to
FORMULA .
Theorem 10.1 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i)–(iii) hold.
(i)
The matrix which represents FORMULA  with respect to the basis (REF ) of FORMULA 
and with respect to the basis (REF ) of FORMULA 
is FORMULA .
(ii)
The matrix which represents FORMULA  with respect to the basis (REF ) of FORMULA 
and with respect to the basis (REF ) of FORMULA 
is FORMULA .
(iii)
The matrix which represents FORMULA  with respect to the basis (REF ) of FORMULA 
and with respect to the basis (REF ) of FORMULA 
is FORMULA .


Proof. (i) Recall that the basis (REF ) of FORMULA  is of the form
FORMULA , where FORMULA  is a nonzero vector in FORMULA .
Similarly, the basis (REF ) of FORMULA  is of the form
FORMULA , where FORMULA  is a nonzero vector in FORMULA .
For FORMULA  each of FORMULA , FORMULA  is an eigenvector for FORMULA  with
eigenvalue FORMULA . The result follows.
(ii), (iii) Similar to the proof of (i) above.  FORMULA
Theorem 10.2 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Consider the following matrix in FORMULA :
FORMULA 
Then the following (i)–(iii) hold.
(i)
The matrix FORMULA  represents FORMULA  with respect to the
bases (REF ) and (REF ) of FORMULA .
(ii)
The matrix FORMULA  represents FORMULA  with respect to the
bases (REF ) and (REF ) of FORMULA .
(iii)
The matrix FORMULA  represents FORMULA  with respect to the
bases (REF ) and (REF ) of FORMULA .


Proof. (i) Recall that the basis (REF ) is of the form
FORMULA  where FORMULA  is a nonzero vector in FORMULA .
Let FORMULA  denote the matrix in FORMULA  which represents FORMULA  with respect to this basis.
We show that FORMULA  is equal to the matrix (REF ).
For FORMULA  we have FORMULA  by (REF )
and (REF ); therefore FORMULA , implying that FORMULA  is
tridiagonal with diagonal entries 0. Further, FORMULA  since FORMULA  and FORMULA .
Therefore FORMULA  by the equation on the left in (REF ).
By these comments
FORMULA 
By (), (REF ) and (REF ) we find
FORMULA . By this and since FORMULA  has endpoint FORMULA  we find
FORMULA . Therefore FORMULA . Now FORMULA  since
FORMULA . As FORMULA  by construction, this
implies FORMULA .
Combining this with the fact that FORMULA  is tridiagonal with diagonal entries 0 we find
FORMULA 
Combining (REF ) and (REF ) and using FORMULA  for FORMULA 
we obtain FORMULA  for FORMULA  and FORMULA  for FORMULA . Therefore
FORMULA  is equal to the matrix (REF ).
Next recall that the basis (REF ) is of the form
FORMULA  where FORMULA  is a nonzero vector in FORMULA .
Let FORMULA  denote the matrix in FORMULA  which represents FORMULA  with respect to this basis.
We show that FORMULA  is equal to the matrix (REF ). Since the proof is similar to the
proof that FORMULA  is equal to the matrix (REF ), we just indicate the main steps.
Similarly as in the first part of the proof, but using Lemma REF  instead of
(REF ), we find that FORMULA  is tridiagonal with diagonal entries 0.
Since FORMULA  we obtain FORMULA  by the equation on the right in
(REF ). Hence
FORMULA 
Further, FORMULA  by Lemma REF  and (REF ), implying
FORMULA . This gives us
FORMULA  since
FORMULA . Hence
FORMULA 
Combining (REF ) and (REF ) we find that FORMULA  is equal to the matrix
(REF ).
(ii), (iii)
Use Theorem REF , Lemma REF  and the comment above Theorem REF .  FORMULA
Theorem 10.3 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Consider the following matrix in FORMULA :
FORMULA 
Then the following (i)–(iii) hold.
(i)
The matrix (REF ) represents FORMULA  with respect to the basis (REF ) of FORMULA .
(ii)
The matrix (REF ) represents FORMULA  with respect to the basis (REF ) of FORMULA .
(iii)
The matrix (REF ) represents FORMULA  with respect to the basis (REF ) of FORMULA .


Proof. (i) Let FORMULA  and FORMULA  denote the matrices in FORMULA  which represent FORMULA , FORMULA  and
FORMULA  with respect to the basis (REF ) of FORMULA . We have FORMULA 
by Lemma REF (ii). Recall that FORMULA  is equal to FORMULA  by
Theorem REF (iii) and that FORMULA  is equal to the matrix (REF ) by Theorem
REF (ii). By these comments FORMULA  is equal to the matrix (REF ).
(ii), (iii)
Use Theorem REF , Lemma REF  and the comment above Theorem REF .  FORMULA
Theorem 10.4 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Consider the following matrix in FORMULA :
FORMULA 
Then the following (i)–(iii) hold.
(i)
The matrix (REF ) represents FORMULA  with respect to the basis (REF ) of FORMULA .
(ii)
The matrix (REF ) represents FORMULA  with respect to the basis (REF ) of FORMULA .
(iii)
The matrix (REF ) represents FORMULA  with respect to the basis (REF ) of FORMULA .


Proof. (i) Let FORMULA  and FORMULA  denote the matrices in FORMULA  which represent FORMULA , FORMULA  and
FORMULA  with respect to the basis (REF ) of FORMULA . We have FORMULA 
by Lemma REF (ii). Recall that FORMULA  is equal to FORMULA  by
Theorem REF (ii) and that FORMULA  is equal to the matrix (REF ) by Theorem
REF (iii). By these comments FORMULA  is equal to the matrix (REF ).
(ii), (iii)
Use Theorem REF , Lemma REF  and the comment above Theorem REF .  FORMULA
Corollary 10.5 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module.
Then the triple FORMULA  acts on FORMULA  as a Leonard triple.

Proof. Immediate from Theorems REF  – REF .  FORMULA

The inner products
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module.
In Lemma REF  we displayed six bases for FORMULA . Later in the paper we will find the
transition matrices between these bases. Before we get to this it is convenient to find the inner
products for the vectors in these bases.
Theorem 11.1 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i)–(iii) hold for FORMULA .
(i)
For a nonzero FORMULA ,
FORMULA 
(ii)
For a nonzero FORMULA ,
FORMULA 
(iii)
For a nonzero FORMULA ,
FORMULA 


Proof. (i) Concerning the equation on the left, it holds for FORMULA  since FORMULA  and
FORMULA  are orthogonal by (REF ). To verify the equation for FORMULA  we first
claim that FORMULA .
To prove the claim we assume FORMULA ; otherwise the result is clear.
By (REF ) and since FORMULA  we have
FORMULA 
In this equation we evaluate both sides using Theorem REF (i) and simplify the result
using the fact that FORMULA  are mutually orthogonal;
we obtain
FORMULA 
The claim follows from this and induction on FORMULA .
Next we claim that FORMULA .
To see this, recall that FORMULA  are mutually orthogonal and that
FORMULA  by the equation on the left in Lemma REF (i).
By these comments and the first claim,
FORMULA 
and the second claim is proved. Combining the two claims we get the equation on the left for FORMULA .
We have now verified the equation on the left. The proof for the equation on the right is similar,
so we just indicate the main steps. If FORMULA  then FORMULA  and FORMULA 
are orthogonal by Lemma REF (ii). Assume now FORMULA . By (REF ) we have
FORMULA . Evaluating and
simplifying this using Theorem REF (i) and the fact that
FORMULA  are mutually orthogonal we obtain
FORMULA . Using induction on FORMULA  we find
FORMULA . Using this and the equation
on the right in Lemma REF (i) we find FORMULA .
Combining the above results we get the equation on the right.
(ii), (iii) Use (REF ), Lemma REF (i), Lemma REF  and
(i) above.  FORMULA
We have a comment.
Theorem 11.2 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i)–(iii) hold for FORMULA 
and nonzero vectors FORMULA , FORMULA , FORMULA .
(i)
FORMULA .
(ii)
FORMULA .
(iii)
FORMULA .


Proof. (i) Each of FORMULA , FORMULA  is a basis for FORMULA  so there exists a nonzero
FORMULA  such that FORMULA . We first claim that
FORMULA . To prove the claim assume FORMULA ; otherwise the result is
clear. Note that FORMULA . Evaluating both sides of
this equation using Theorem REF (ii) and Theorem REF (ii) and then comparing the
results we find that FORMULA . The claim follows from this and induction
on FORMULA . Next we claim that FORMULA .
To see this recall that FORMULA  and FORMULA 
by Lemma REF (ii),(iii). By this, (REF ), Theorem REF (ii) and the first
claim we find
FORMULA 
and the second claim follows. Combining the two claims we obtain the desired result.
(ii), (iii) Use (REF ), Lemma REF (i), Lemma REF  and
(i) above.  FORMULA
Corollary 11.3 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA . Let FORMULA , FORMULA , FORMULA  denote nonzero vectors
in FORMULA , FORMULA , FORMULA , respectively. Then each of FORMULA , FORMULA ,
FORMULA  is nonzero.

Proof. The vectors FORMULA , FORMULA  and FORMULA  are nonzero by Lemma REF .
Combining this with Theorem REF  we get the result.  FORMULA
Theorem 11.4 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i)–(iii) hold for FORMULA 
and nonzero vectors FORMULA , FORMULA , FORMULA .
(i)
FORMULA .
(ii)
FORMULA .
(iii)
FORMULA .


Proof. Immediate from Theorem REF  and Theorem REF .  FORMULA
Before proceeding we recall a definition. For an integer FORMULA  and FORMULA  we define
FORMULA 
We interpret FORMULA . For integers FORMULA  we define
FORMULA 
The sum (REF ) is an example of a hypergeometric series {{cite:f638dba7-c256-48b2-a8d5-79ad4c3a03d3}}.
We will use the fact that
FORMULA 
provided FORMULA . Line (REF ) follows from {{cite:f3af51bb-e2bd-492a-8641-769070a5280a}} and since each
side of (REF ) is equal to FORMULA  {{cite:f3af51bb-e2bd-492a-8641-769070a5280a}} where the
FORMULA  are the Krawtchouk polynomials.
Theorem 11.5 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i)–(iii) hold for FORMULA 
and nonzero vectors FORMULA , FORMULA , FORMULA .
(i)

FORMULA 
(ii)

FORMULA 
(iii)

FORMULA 


Proof. (i) We first claim that
FORMULA 
We will follow the approach of Go {{cite:e1f87611-1482-4531-918b-9bbb42ea91df}} and prove the claim using induction
on FORMULA . It is clear that (REF ) holds for FORMULA . Assume now FORMULA ; otherwise we are done.
To show that (REF ) holds for FORMULA  observe by (REF ),
Theorem REF (i) and Theorem REF (i) that
FORMULA 
Similarly (REF ) holds for FORMULA  since
FORMULA 
To show that (REF ) holds for FORMULA , observe by (REF ), Theorem REF (ii)
and Theorem REF (ii) that
FORMULA 
and that the last expression is equal to FORMULA  by (REF ).
For the rest of this proof assume FORMULA  and FORMULA  or FORMULA ; otherwise we are done.
We first assume FORMULA . By Theorem REF (ii),
FORMULA 
Using this, (REF ) and Theorem REF (ii) we obtain
FORMULA 
By the induction hypothesis the right-hand side of (REF ) is equal to
FORMULA  times
FORMULA 
Evaluating the above expression using (REF ) we obtain (REF ).
Now assume FORMULA . By Theorem REF (i),
FORMULA 
Using this, (REF ) and Theorem REF (i) we obtain
FORMULA 
By the induction hypothesis the right-hand side of (REF ) is equal to
FORMULA  times
FORMULA 
Evaluating the above expression using (REF ) we obtain (REF )
and our first claim is proved.
Next we claim that FORMULA . To see this, observe
by (REF ), (), (), Lemma REF (ii) and (REF ) that
FORMULA 
and the second claim follows. Combining the two claims we get the desired result.
(ii), (iii) Use (REF ), Lemma REF (i), Lemma REF  and
(i) above.  FORMULA
Theorem 11.6 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i)–(iii) hold for FORMULA 
and nonzero vectors FORMULA , FORMULA , FORMULA .
(i)

FORMULA 
(ii)

FORMULA 
(iii)

FORMULA 


Proof. (i)
By Theorem REF (ii) and (REF ),
FORMULA 
We claim that FORMULA .
To see this, observe
by (REF ), (), (), Lemma REF (ii) and (REF ) that

FORMULA 

and the claim follows.
Combining (REF ) with the claim we get the desired result.
(ii), (iii) Use (REF ), Lemma REF (i), Lemma REF  and
(i) above.  FORMULA
Theorem 11.7 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i)–(iii) hold for FORMULA 
and nonzero vectors FORMULA , FORMULA , FORMULA .
(i)

FORMULA 
(ii)

FORMULA 
(iii)

FORMULA 


Proof. (i) By Theorem REF (i),(ii) and (REF ),
FORMULA 
We claim that FORMULA .
To see this, observe
by (REF ), (), (), Lemma REF (i) and (REF ) that
FORMULA 
and the claim follows. Combining (REF ) with the claim we get the desired result.
(ii), (iii) Use (REF ), Lemma REF (i), Lemma REF  and
(i) above.  FORMULA
Theorem 11.8 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i)–(iii) hold for FORMULA 
and nonzero vectors FORMULA , FORMULA , FORMULA .
(i)

FORMULA 
(ii)

FORMULA 
(iii)

FORMULA 


Proof. (i)
By Theorem REF (i),
FORMULA 
The result now follows from Theorem REF (iii).
(ii), (iii) Use (REF ), Lemma REF (i), Lemma REF  and
(i) above.  FORMULA

The inner products between FORMULA , FORMULA  and  FORMULA
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA , and pick nonzero vectors FORMULA , FORMULA ,
FORMULA . In this section we display some equations
involving the inner products between FORMULA .
Theorem 12.1 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Then the following (i)–(iii) hold for nonzero vectors
FORMULA , FORMULA , FORMULA .
(i)
FORMULA .
(ii)
FORMULA .
(iii)
FORMULA .


Proof. (i)
Using Theorem REF (iii) and Theorem REF (ii) we obtain
FORMULA 
Comparing the above value for FORMULA  with the value given in
Theorem REF (ii) we obtain the desired result.
(ii), (iii) Similar to the proof of (i) above.  FORMULA
Corollary 12.2 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Pick nonzero vectors
FORMULA , FORMULA , FORMULA . Then the scalar
FORMULA 
is real and positive.

Proof. By Theorem REF (i) the scalar (REF ) is equal to
FORMULA . By construction FORMULA  is real
and positive. Also FORMULA  is real and positive since
FORMULA  by construction and FORMULA 
by Corollary REF . The result follows.  FORMULA
With reference to Theorem REF , the inner products FORMULA , FORMULA  and
FORMULA  are independent in the following sense.
Lemma 12.3 
Let FORMULA  be such that FORMULA  is a positive real number. Then
there exist nonzero vectors FORMULA , FORMULA , FORMULA  such
that FORMULA , FORMULA , FORMULA .

Proof. Note that each of FORMULA  is nonzero.
Pick arbitrary nonzero vectors FORMULA , FORMULA , FORMULA 
and define FORMULA .
Also define FORMULA ,
FORMULA , FORMULA .
These scalars are well-defined by Corollary REF .
We now define FORMULA , FORMULA , FORMULA  and
routinely obtain FORMULA , FORMULA , FORMULA  using
Theorem REF .  FORMULA

The transition matrices
In this section we display the transition matrices between the bases introduced in Section
. We start with a comment. With reference to Notation REF , let FORMULA  denote
an irreducible FORMULA -module with endpoint FORMULA  and diameter FORMULA . Let FORMULA  and
FORMULA  denote bases for FORMULA .
By the transition matrix from FORMULA  to FORMULA 
we mean the matrix FORMULA  which satisfies
FORMULA 
We recall a few properties of transition matrices. Let FORMULA  denote the transition matrix from
FORMULA  to FORMULA . Then FORMULA  is invertible and FORMULA  is
the transition matrix from FORMULA  to FORMULA .
If FORMULA  are mutually orthogonal
then the entries of FORMULA  are given by
FORMULA 
In order to display the transition matrices in a compact form we abbreviate
FORMULA 
and
FORMULA 
Theorem 13.1 
With reference to Notation REF , let FORMULA  denote an irreducible FORMULA -module
with endpoint FORMULA  and diameter FORMULA . Pick nonzero vectors
FORMULA , FORMULA , FORMULA .
Then the transition matrices between the bases (REF ) – (REF ) are given in the
tables below.
 TABLE
 TABLE

Proof. Combine Theorem REF , Theorems REF  – REF  and (REF ).  FORMULA
Acknowledgement: The author would like to thank Paul Terwilliger
for proposing the problem and for his careful reading of the earlier versions
of this manuscript.
