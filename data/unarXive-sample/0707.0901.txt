
=1
Effect of time delay on feedback control of a flashing ratchet
Delayed feedback control of ratchet
E. M. Craig1, B. R. Long1, J. M. R. Parrondo2 H. Linke1
E. M. Craig
1 Department of Physics, Materials Science Institute, University of Oregon - Eugene, OR USA 97403
2 Dep. de Física Atómica, Molecular y Nuclear and GISC, Universidad Complutense de Madrid, 28040-Madrid, Spain

05.40.-aFluctuation phenomena, random processes, noise, and Brownian motion.
02.30.YyControl theory.
It was recently shown that the use of feedback control can improve the performance of a flashing ratchet. We investigate the effect of a time delay in the implementation of feedback control in a closed-loop collective flashing ratchet, using Langevin dynamics simulations. Surprisingly, for a large ensemble, a well-chosen delay time improves the ratchet performance by allowing the system to synchronize into a quasi-periodic stable mode of oscillation that reproduces the optimal average velocity for a periodically flashing ratchet. For a small ensemble, on the other hand, finite delay times significantly reduce the benefit of feedback control for the time-averaged velocity, because the relevance of information decays on a time scale set by the diffusion time of the particles. Based on these results, we establish that experimental use of feedback control is realistic.
Introduction
Flashing ratchets rectify the thermal motion of diffusive particles by exposing them to a time-dependent, spatially periodic and asymmetric potential {{cite:dcb46874-e503-4858-8005-4435beb98a3e}}, {{cite:3e42f46e-b7eb-4b7d-885b-dd8b8296ad8a}}, {{cite:bee6d7c6-e151-43cf-b3d9-cd269ae6e13e}}, {{cite:85b407b2-4efb-4132-b4c5-d6c1764db50e}}, {{cite:dce16128-81be-4e8d-b118-586e58549b0c}}. These systems are attracting significant interest {{cite:b9e01fa3-ecbe-4a2a-af93-41a2bccab27f}} because they may be applied, for example, in particle separation {{cite:4e33c288-e146-442b-aaac-97bf4661eed5}}, {{cite:f521b087-299f-45d0-b91b-2d6872b7d18e}} or as a power source for polymer motors {{cite:27f0fe68-8d3e-45c5-940a-5bc280230624}}. In addition, flashing ratchets are one of the simplest realizations of Brownian motors in general {{cite:85b407b2-4efb-4132-b4c5-d6c1764db50e}}, and are therefore of fundamental interest in non-equilibrium statistical mechanics and as models for synthetic {{cite:73a1d7b7-21bf-4220-8408-0560238ad6c4}} or biological {{cite:c88a91de-18d7-4860-bda7-1db4b0727d76}} molecular motors.
In most studies of flashing ratchets, the potential is switched periodically or randomly, without regard to the particle distribution. Recently, a flashing ratchet with feedback control was introduced, where the external potential depends on the state of the system {{cite:d0f149c8-e8e3-4d54-bd7c-08974d735c05}}. The instantaneous center-of-mass velocity was maximized by turning the potential on only when the ensemble-averaged force exerted by the potential would be positive. This strategy maximizes the time-averaged center-of-mass velocity for one particle (FORMULA ) and performs better than a periodically flashing ratchet for FORMULA . However, because fluctuations are needed to trigger the next switching event, the time-averaged velocity goes to zero for large FORMULA  where center-of-mass fluctuations become rare. In an improved feedback strategy {{cite:f4932ff6-3266-4910-8dab-162a053751bd}}, the potential is switched on (off) whenever the average force increases (decreases) through set thresholds, eliminating the need to wait for fluctuations. This protocol performs as well as the feedback strategy in {{cite:d0f149c8-e8e3-4d54-bd7c-08974d735c05}} for FORMULA , and yields approximately the same current as optimal periodic flashing for large FORMULA .
In an experiment designed to implement such feedback strategies, there will be a finite time lag between the collection of information and any feedback to the system because of the time it takes to acquire an image of particles, and to determine the particle positions and ensemble averages. Delayed feedback has been demonstrated to produce complicated dynamics in chaotic, inertial ratchets {{cite:e32d0745-2c22-4b74-8c67-5acc9dc31f5e}}, {{cite:5e32af01-eaea-4f72-bce3-f866f6bf0c5f}}, {{cite:eb7070a0-1fed-4d2c-b7ff-ab00587e5657}}, stochastic systems that display a Hopf bifurcation (oscillatory instability) in the absence of delay {{cite:e586af9d-3a97-4750-bcc0-6f19e6ea2eba}} and biological systems {{cite:e8719b1c-d7e9-41cd-990b-174be54f5426}}, {{cite:bf628ba6-01f6-4545-8061-c08f85f1bdc3}}, {{cite:beaee343-70a8-4f2e-a936-10f4a24160aa}}, and some analytical methods have recently been developed to study time delay in stochastic systems {{cite:d7bd081c-ad97-4cdf-bd05-4bac94bbd47b}}, {{cite:50d81ed3-7559-44bc-b830-a64f0323230e}}, {{cite:b589297e-8b19-4c22-9f07-e340ba468046}}. Here we study the impact of time delay on the effectiveness of the feedback control strategy introduced in {{cite:d0f149c8-e8e3-4d54-bd7c-08974d735c05}}.
For a small number of particles (less than FORMULA ), we find that finite delay times in the feedback significantly reduce the average velocity, because the quality of the collected information decays on the scale of the system's characteristic diffusion time. This is consistent with the result {{cite:12a672ae-9d19-4482-a4b0-efe186ad8473}} that loss of information about the system limits the improvement of the flux for the feedback ratchet strategy in {{cite:d0f149c8-e8e3-4d54-bd7c-08974d735c05}} over a periodically flashing ratchet. On the other hand, for the quasi-deterministic case of FORMULA , we find that a well-chosen delay time effectively reproduces the advantageous threshold protocol in {{cite:f4932ff6-3266-4910-8dab-162a053751bd}} even though no threshold criterion is actually used in the algorithm. As a result, a time delay in the control strategy of {{cite:d0f149c8-e8e3-4d54-bd7c-08974d735c05}} surprisingly can increase the average current. Somewhat paradoxically, the system is found not only to tolerate, but actually to benefit from the experimental “handicap" of finite time lags.

Model
We consider the following one-dimensional system discussed in Cao et. al. {{cite:d0f149c8-e8e3-4d54-bd7c-08974d735c05}}: An ensemble of FORMULA  non-interacting, overdamped particles is exposed to a spatially periodic, piecewise linear `sawtooth' potential FORMULA , characterized by the spatial period, FORMULA , height FORMULA , and asymmetry FORMULA  (Fig. REF ). The motion of the particles is described by the Langevin equations:
FORMULA 
where FORMULA  is the position of particle FORMULA , FORMULA  is the drag coefficient of a particle, and FORMULA  is a randomly fluctuating Gaussian white noise term with zero mean and correlation FORMULA . The external force is given by FORMULA , and FORMULA  is a control parameter which can take the value of 1 or 0, thus switching the external potential on or off.
In {{cite:d0f149c8-e8e3-4d54-bd7c-08974d735c05}}, the following two control strategies are compared:
(1) Periodic switching: FORMULA , with FORMULA  for FORMULA , and FORMULA  for FORMULA .
(2) Controlled switching (maximization of the instantaneous center-of-mass velocity):
FORMULA 
where
FORMULA 
is the ensemble average of the force the particles would feel if the potential were on, and FORMULA  is the Heaviside function, FORMULA  if FORMULA  and 0 otherwise.
Here, we consider two distinct types of time delay in the feedback control (Fig. REF ):
(1) Implementation time, FORMULA : If a measurement is taken at time FORMULA , any feedback (i.e. a possible change in potential) based on this measurement will occur at time FORMULA . This type of delay is caused by data processing in an experiment.
(2) Measurement interval, FORMULA : If a measurement is taken at time FORMULA , the next measurement will be taken at time FORMULA . This type of delay could be due to a limit in the readout rate of a camera system which acquires images of the particle distribution.
We use Langevin dynamics simulations to study the effect of these time delay parameters on the average particle velocity achieved by the control strategy described by eq. REF . In the presence of time delay, the motion of the particles is given by
FORMULA 
where FORMULA  is the actual state of the system based on a delayed response to the cue FORMULA . In all simulations, FORMULA , FORMULA , FORMULA , and FORMULA . We will use FORMULA  unless otherwise stated. The finite time step, FORMULA , in a Langevin dynamics calculation introduces an unintended measurement delay FORMULA , but by choosing a sufficiently small FORMULA , we can examine the behavior of the system in the FORMULA  limit (for example, for FORMULA , we use FORMULA ). To measure ratchet performance, we calculate the time-averaged center-of-mass velocity, FORMULA . We have tested that FORMULA  does not depend on the initial distribution, when averaged over a long enough period of time.

Results
We begin by considering the effect of implementation delay, FORMULA , with zero measurement interval (FORMULA ), and show in fig. REF  FORMULA  as a function of FORMULA  for different FORMULA . The impact of implementation delay on feedback effectiveness depends on the ensemble size as follows:
Small FORMULA : For FORMULA  and perfect feedback (FORMULA ), we reproduce the result FORMULA  FORMULA  {{cite:d0f149c8-e8e3-4d54-bd7c-08974d735c05}}, an order of magnitude faster than the velocity FORMULA  for optimal periodic flashing without feedback for all FORMULA  (FORMULA ). However, the velocity decreases very quickly with FORMULA : for FORMULA , FORMULA  drops below FORMULA  for delay greater than FORMULA  (fig. REF ). This time scale is reasonable when one considers that the distance, FORMULA , a particle diffuses during FORMULA  is about FORMULA , comparable to the ratchet's critical length scale of FORMULA . In other words, for small FORMULA , the implementation delay at which the feedback strategy loses effectiveness is comparable to the correlation time between measured and actual particle positions with respect to the potential features.
Large FORMULA ; small FORMULA : As the number of particles increases, center-of-mass fluctuations become more rare, and the time-evolution of the ensemble becomes more deterministic. Thus, for larger ensembles, the effect of a short implementation delay FORMULA  can be visualized by inspecting the characteristic time development of FORMULA  for FORMULA  (fig. REF ). Initially, the potential is on and the particles are equilibrated, so that FORMULA . A fluctuation that yields FORMULA  produces a cue to turn the potential off (setting FORMULA  to zero), which is implemented a time FORMULA  later (FORMULA  for FORMULA ). This leads to a rapid decrease of FORMULA  because half of the particles quickly diffuse into an area with a large negative force. Rapid shifts in FORMULA  occur for a duration of about FORMULA , as FORMULA  switches in response to previous cues. Once FORMULA  becomes steady, the system approaches its new equilibrium state. Near the new equilibrium, a center-of-mass fluctuation yields FORMULA , and after a delay of FORMULA  the potential is turned on, rapidly pushing the particles down the potential slopes (the steeper slope is cleared first, yielding an initial increase of FORMULA ). Again, fluctuations in FORMULA  are observed for a duration of about FORMULA  before FORMULA  becomes steady. For small FORMULA , the velocity is reduced due to the additional time spent near equilibrium before a cue is implemented and the unproductive fluctuations in FORMULA  after the potential is switched.
Large FORMULA ; large FORMULA : For large FORMULA , we find that a finite value of FORMULA  can be chosen such that FORMULA  surprisingly is larger than in the absence of time delay. This result is initially unexpected because for FORMULA , FORMULA  achieved by the feedback mechanism used here (eq. REF ) falls short of FORMULA , even without the experimental handicap of finite implementation delay {{cite:d0f149c8-e8e3-4d54-bd7c-08974d735c05}}. To understand how implementation delay can actually improve the performance of a feedback mechanism, note that FORMULA  essentially becomes deterministic for large FORMULA . As shown in fig. REF (b), for FORMULA , after a small number of initial cycles, a cue created in one cycle of the potential correctly triggers a switching event in the next cycle. This mode is stable when FORMULA  is larger than the duration of the initial transient toward the maximum FORMULA  that is observed after each switching event, because a potential switch after the system moves through the maximum FORMULA  will trigger a sign change of FORMULA , and thus a new cue. For the parameters used here, the maximum FORMULA  is reached after about FORMULA , which is consistent with our observation that FORMULA  increases with FORMULA  for FORMULA  when FORMULA .
A key result of this paper is that, for a large enough ensemble, there is a range of implementation delays that improve the performance of a feedback-controlled ratchet by allowing the system to synchronize into a stable mode of oscillation that does not rely on fluctuations to trigger a change in the potential. If FORMULA  is longer than the initial approach to the maximum FORMULA  in the characteristic time-evolution of FORMULA  (FORMULA ), then a cue created in one cycle can trigger a switching event in the next cycle. This produces a stable mode of oscillation with a period of about FORMULA  (fig. REF (b)). Thus, for FORMULA , the system operates at FORMULA  (Fig. REF (a)). The inset of fig. REF (a) shows that this behavior is qualitatively independent of FORMULA , noting that FORMULA  is itself a function of FORMULA . For increasing FORMULA , FORMULA  is reached for smaller FORMULA , because less time is required for the particles to localize in the potential, decreasing the implementation delay necessary to achieve FORMULA .
Interestingly, for even larger FORMULA  (we investigated up to FORMULA ), the system usually finds a mode in which cues are implemented multiple periods in the future. In this case, it can take hundreds of cycles for the system to stabilize in this mode of operation. As seen in fig. REF (b), for values of FORMULA  such that a cue is implemented after two cycles (at around FORMULA ), the stable period is FORMULA . Near the boundary between two modes, the system can synchronize into either mode. In the range of FORMULA , the system has been observed to become metastably synchronized into one quasi-periodic mode for several hundred cycles before locking into the other mode (for example, see inset to fig. REF (b)). For FORMULA , we observe these stable modes for at least FORMULA  cycles, and one can expect that periodic modes of oscillation will always remain stable in the deterministic limit of large FORMULA .
Measurement delay: The synchronized behavior discussed above relies on the arrival of one cue triggering a new cue of the same sign. We now examine the impact of a finite measurement interval, FORMULA , on this synchronization, for several values of FORMULA  relative to FORMULA . For FORMULA  (fig. REF (a)), broadly speaking, we observe two regimes of behavior: (1) For FORMULA , we see qualitatively the same behavior as for FORMULA , except that the velocity versus FORMULA  behavior shifts to smaller FORMULA , because increasing FORMULA  increases the period of the synchronized cycles. If FORMULA  is not close to being an integer multiple of FORMULA , for example FORMULA , FORMULA  is not achieved because a new measurement is taken before the previous measurement has been implemented, which interferes with the synchronization necessary to produce optimized periodic flashing. (2) For FORMULA , a new cue is sent after the force has switched signs in response to the previous cue, so the synchronization-induced increase in the average velocity with FORMULA  does not occur.
On the other hand, for small FORMULA , the velocity decreases with FORMULA  for any value of FORMULA  (shown for FORMULA  in fig. REF (b)), because increasing FORMULA  decreases the level of correlation between the particle distribution when the cue is taken and when it is implemented. Interestingly, for FORMULA , the falloff in velocity with respect to FORMULA  is not as steep as when FORMULA  for the following reason: A finite measurement interval FORMULA  allows the ensemble to evolve before the next cue is taken, which decreases the amount of unproductive rapid oscillations. For FORMULA , the velocity is slower than when FORMULA , because there is idle time in each cycle before a new measurement is taken.

Experimental feasibility
To place the time scales discussed here into a quantitative context, consider a possible experimental implementation that uses an interdigitated electrode array to expose charged, colloidal particles such as carboxylate-modified, fluorescent polystyrene beads to a time-dependent, asymmetric, electrostatic potential. Such flashing ratchet devices have been used previously with DNA molecules {{cite:4e33c288-e146-442b-aaac-97bf4661eed5}}. A feedback operation in such a system will require: (I) acquisition of a 2D image using a CCD camera; (II) numerical determination of particle locations; (III) decision whether to switch the potential; and (IV) change of voltage applied across the array. The total time for operations (I) - (IV) corresponds to FORMULA  in fig. REF . The camera exposure time (step I) often limits the rate at which images can be acquired and corresponds roughly to FORMULA  in fig. REF  The correspondence between exposure time and FORMULA  as defined in fig. REF  is not exact because, in an experiment, particle positions are averaged over the exposure time, whereas in our numerical studies particle positions are collected instantaneously at the end of FORMULA . Nevertheless, our general discussion of relevant time scales holds true..
For small FORMULA , fig. REF  shows that to fully benefit from feedback, delay times should be kept below about FORMULA . Feedback schemes to control the position of a single, fluorescent particle have been implemented with rates up to 300 Hz {{cite:d431554e-2a83-4e1f-baee-e1d8f7e54ed7}}. If we assume FORMULA  for small FORMULA , then FORMULA  when FORMULA  for beads of diameter FORMULA  in an aqueous environment (viscosity FORMULA , FORMULA ). In other words, for FORMULA , a ratchet with FORMULA  or larger could yield almost the full theoretical benefit of feedback. Electrodes of this size can easily be fabricated using standard lithography.
The rates quoted above are accessible when a small subset of the CCDÕs pixels are used. For FORMULA , a full-size (for example 512 x 512) image would be needed, yielding a typical exposure and readout time from a high-sensitivity CCD camera of about FORMULA . Ideally, operations (II)-(IV) are performed while the next image is collected by the camara, such that total delay times of order FORMULA  are realistic. To observe the effect of feedback delay on ratchet transport shown in Fig. REF , it is desirable to vary FORMULA  across the range FORMULA . For delay times on the order FORMULA , one therefore requires FORMULA . For beads of diameter FORMULA  in an aqueous environment exposed to a ratchet potential with FORMULA , we find FORMULA  for FORMULA .
The time scale FORMULA  scales linearly with FORMULA  for fixed FORMULA  and can thus easily be adjusted by changing the particle size. If locating individual particles is either too slow or limited by image resolution, it should be possible to establish the desired feedback protocols by measuring density distributions. The effects demonstrated above numerically are most clearly observable for potential depths of several FORMULA  or more. In water, commercially available FORMULA  carboxylate-modified polystyrene beads have a charge FORMULA , so an electrostatic potential in the FORMULA  range should create a trapping strength FORMULA  much greater than FORMULA . It therefore appears realistic in principle to experimentally explore the key results presented here.

Concluding remarks
In conclusion, we established that an implementation delay on the order of the diffusion time over the length of the negative-slope portion of the ratchet potential significantly compromises the performance of a feedback-controlled flashing ratchet for small particle numbers (fewer than FORMULA ). However, we found that for larger particle numbers, an implementation delay actually improves the performance of the feedback strategy introduced by Cao et al. {{cite:d0f149c8-e8e3-4d54-bd7c-08974d735c05}}, and matches the performance of an optimally periodic potential modulation, similar to the feedback mechanism discussed in {{cite:f4932ff6-3266-4910-8dab-162a053751bd}}, even for surprisingly long delay times.
We have demonstrated that this key result is true in general for FORMULA , independent of the potential depth and the initial conditions. We expect that the transition between the (`nondeterministic') low FORMULA  behavior and the (`deterministic') high FORMULA  behavior is weakly dependent on FORMULA . For the relevant case of potential depths of several FORMULA  or more, increasing the potential will have minimal effect on how deterministic the system is, and the transition between `low FORMULA ' and `high FORMULA ' regimes will depend most critically on the behavior of the ensemble when the potential is off. We have modeled the role of time delay in feedback control of a ratchet over a range of parameters that would be feasible to implement experimentally.
Note: After submission, two preprints {{cite:a33f21e5-1d9f-4c4d-bb9a-ee0afee92ef5}}, {{cite:ff14a570-27e6-4c4e-ab5a-0cd3a9b981a5}} came to our attention, which use a combination of numerical and analytical methods {{cite:d7bd081c-ad97-4cdf-bd05-4bac94bbd47b}} to study the role of implementation time delay in a flashing ratchet.
FIGURE 
FIGURE 
FIGURE 
FIGURE 
FIGURE 
FIGURE 
We are grateful to Martin Zuckermann and Ben Lopez for helpful discussions. This research is based upon work supported by the National Science Foundation under CAREER Grant No. 0239764, and has been enabled by the use of the Bugaboo computing facility and the IRMACS center of Simon Fraser University, which are funded in part by the Canada Foundation for Innovation. J. M. R. P. acknowledges financial support from Ministerio de Educación y Ciencia (Spain), grant MOSAICO, and from BCSH, grant UCM PR27/05-13923.
